<!DOCTYPE html><html lang="en" class=" ltr " data-doctype="true" dir="ltr" ontouchend="CustomEvent.fireAll('body_clicked', event);"><head><script>document.addEventListener('click', function (event) {
				CustomEvent.fireAll('body_clicked', event);
			});
			document.hasBodyClickedTrigger = 'true';</script><script type="text/javascript"></script><script src="/uxasset/externals/service-worker/loader.jsdbx?uxpcb=1715272537078&amp;sysparm_substitute=false"></script><script>function getLinkElementGenerator(asValue, withCrossOrigin) {
					return function (url) {
						if (!url)
							return;

						var link = document.createElement('link');
						link.setAttribute('rel', 'preload');
						link.setAttribute('as', asValue);
						link.setAttribute('href', url);

						if (withCrossOrigin)
							link.setAttribute('crossorigin', true);

						return link;
					}
				}
				var fontAssets = '/uxta/68f8ed5853546010b846ddeeff7b127c.assetx,/uxta/f93a299853546010b846ddeeff7b12b5.assetx,/uxta/c69aa99853546010b846ddeeff7b1256.assetx,/uxta/a232a471c7102010d447c17cf4c2604d.assetx,/uxta/5872a471c7102010d447c17cf4c2604b.assetx,/uxta/7382e471c7102010d447c17cf4c260b2.assetx,/uxta/b0c2a871c7102010d447c17cf4c260a3.assetx,/uxta/b4932c71c7102010d447c17cf4c26086.assetx,/uxta/f434a4b1c7102010d447c17cf4c26030.assetx,/uxta/eab360b1c7102010d447c17cf4c2603f.assetx,/uxta/1a9967bab7b0201041aa9aedce11a932.assetx,/uxta/c79c3863771220104fdc5ed999106188.assetx,/uxta/bf5ac16b771220104fdc5ed999106179.assetx,/uxta/f19a856b771220104fdc5ed9991061aa.assetx,/uxta/79aa856b771220104fdc5ed9991061a5.assetx,/uxta/fcba856b771220104fdc5ed9991061af.assetx,/uxta/a8ca096b771220104fdc5ed99910612b.assetx,/uxta/649bcd6b771220104fdc5ed9991061e1.assetx,/uxta/26ffc05d770130104fdc5ed999106112.assetx,/uxta/c630145d770130104fdc5ed999106141.assetx'.split(',');

				var mswDisabledValue = "false";
				var disabled = mswDisabledValue === 'true' ? true : false;
				var serviceWorkers = JSON.parse("[{\"scope\":\"/\",\"serviceWorkerUrl\":\"/uxsw/scope/root.js\"}]");
				var cacheBuster = "1715272537078";
				var assetPublicPath = "/uxasset/externals/";
				var SERVICE_WORKER_MANAGER_CONFIG = {disabled: disabled, serviceWorkers: serviceWorkers};
				if (window.serviceWorkerManager) window.serviceWorkerManager.init(SERVICE_WORKER_MANAGER_CONFIG);
				var prefetchedAssetsStr = "";
				var defaultPrefetchedAssets = [
					'/uxasset/externals/amb-client-js/index.jsdbx',
					'/uxasset/externals/@devsnc/library-uxf/index.jsdbx',
					'/uxasset/externals/@servicenow/ui-mega/index.jsdbx',
					'/uxasset/externals/nds-megabundle/bundled-assets.jsdbx',
					'/uxasset/externals/polaris-app-shell/index.jsdbx',
					'/uxasset/externals/js-common-mega/bundled-assets.jsdbx',
					'/uxasset/externals/controls-mono/bundled-assets.jsdbx',
					'/uxasset/externals/lodash/latest/index.jsdbx',
					'/uxasset/externals/sn-http-request/latest/index.jsdbx',
					'/uxasset/externals/@servicenow/ui-renderer-react/index.jsdbx',
					'/uxasset/externals/react-dnd/latest/index.jsdbx',
					'/uxasset/externals/react-dnd-html5-backend/latest/index.jsdbx',
					'/uxasset/externals/@devsnc/ux-metrics-runtime/index.jsdbx',
					'/uxasset/externals/@devsnc/ux-metrics-client-interaction-subscriber/index.jsdbx',
					'/uxasset/externals/@devsnc/ux-metrics-appsee-subscriber/index.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/chevronDown.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/star.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/pencilPage.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/close.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/home.jsdbx',
					'/uxasset/externals/sn-component-workspace-global-search/index.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/ellipsisVertical.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/user.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/gear.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/eye.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/openLinkRight.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/squareArrowLeft.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/loader.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/presenceAvailable.jsdbx',
					'/uxasset/externals/@devsnc/library-appsee-web-sdk/latest/index.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/magnifyingGlass.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/plus.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/ellipsisHorizontal.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/list.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/analyticsCenter.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/document.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/window.jsdbx',
					'/uxasset/externals/@devsnc/library-form/latest/index.jsdbx',
					'/uxasset/externals/@servicenow/now-resizable-panes/index.jsdbx',
					'/uxasset/externals/@devsnc/sn-scripting-environment/index.jsdbx',
					'/uxasset/externals/@servicenow/now-uxf-tab-set/index.jsdbx',
					'/uxasset/externals/sn-component-timeago/index.jsdbx',
					'/uxasset/externals/@servicenow/condition-builder-commons/latest/index.jsdbx',
					'/uxasset/externals/@devsnc/sn-contact-card/index.jsdbx',
					'/uxasset/externals/@servicenow/now-scripting-ui-components/index.jsdbx',
					'/uxasset/externals/@devsnc/sn-scripted-modal/index.jsdbx',
					'/uxasset/externals/sn-canvas-chrome/index.jsdbx',
					'/uxasset/externals/@devsnc/sn-layout/index.jsdbx',
					'/uxasset/externals/date-fns/latest/index.jsdbx',
					'/uxasset/externals/dompurify/latest/index.jsdbx',
					'/uxasset/externals/@servicenow/now-uxf-page/index.jsdbx',
					'/uxasset/externals/@devsnc/ux-metrics/index.jsdbx',
					'/uxasset/externals/sn-canvas-core/index.jsdbx',
					'/uxasset/externals/sn-search-input-wrapper/index.jsdbx',
					'/uxasset/externals/path-to-regexp/latest/index.jsdbx',
					'/uxasset/externals/fflate/latest/index.jsdbx',
					'/uxasset/externals/sn-canvas-core-addon/latest/index.jsdbx',
					'/uxasset/externals/cuid/latest/index.jsdbx',
					'/uxasset/externals/sn-canvas-blank/index.jsdbx',
					'/uxasset/externals/sn-ux-core/latest/index.jsdbx',
					'/uxasset/externals/sn-canvas-common/latest/index.jsdbx',
					'/uxasset/externals/sn-component-workspace-agent-assist/index.jsdbx',
					'/uxasset/externals/@servicenow/now-record-list-connected/index.jsdbx',
					'/uxasset/externals/@servicenow/now-stylized-text/index.jsdbx',
					'/uxasset/externals/@devsnc/sn-list-commons/index.jsdbx',
					'/uxasset/externals/@servicenow/sass-kit/latest/index.jsdbx',
					'/uxasset/externals/interactjs/latest/index.jsdbx',
					'/uxasset/externals/@servicenow/now-record-list-filter-panel/index.jsdbx',
					'/uxasset/externals/@servicenow/now-record-list-menu-connected/index.jsdbx',
					'/uxasset/externals/@servicenow/now-grid/index.jsdbx',
					'/uxasset/externals/@servicenow/now-condition-builder-preview/index.jsdbx',
					'/uxasset/externals/@servicenow/now-condition-builder/index.jsdbx',
					'/uxasset/externals/@devsnc/library-vtb-commons/latest/index.jsdbx',
					'/uxasset/externals/@servicenow/now-record-list-panel/index.jsdbx',
					'/uxasset/externals/@servicenow/now-condition-builder-record-count/index.jsdbx',
					'/uxasset/externals/@servicenow/now-record-list/index.jsdbx',
					'/uxasset/externals/@servicenow/now-pagination/index.jsdbx',
					'/uxasset/externals/@servicenow/now-record-form-connected/index.jsdbx',
					'/uxasset/externals/sn-tinymce/latest/index.jsdbx',
					'/uxasset/externals/@servicenow/behavior-dynamic-translation/latest/index.jsdbx',
					'/uxasset/externals/@devsnc/sn-declarative-actions/index.jsdbx',
					'/uxasset/externals/@devsnc/uxf-effect-component-loader/latest/index.jsdbx',
					'/uxasset/externals/updeep/latest/index.jsdbx',
					'/uxasset/externals/@servicenow/now-dot-walk/index.jsdbx',
					'/uxasset/externals/sn-component-file-icon/index.jsdbx',
					'/uxasset/externals/@servicenow/now-grid-commons/latest/index.jsdbx',
					'/uxasset/externals/lodash/4.17.21/function.jsdbx',
					'/uxasset/externals/lodash-move/latest/index.jsdbx',
					'/uxasset/externals/@devsnc/sn-drag-and-drop/index.jsdbx',
					'/uxasset/externals/moment/latest/index.jsdbx',
					'/uxasset/externals/@servicenow/now-email-client/index.jsdbx',
					'/uxasset/externals/@servicenow/now-link-interceptor-behavior/index.jsdbx',
					'/uxasset/externals/sn-user-preferences/index.jsdbx',
					'/uxasset/externals/@servicenow/now-record-common/index.jsdbx',
					'/uxasset/externals/servicenow-now-contextual-sidebar/index.jsdbx',
					'/uxasset/externals/resize-observer-polyfill/latest/index.jsdbx',
					'/uxasset/externals/@servicenow/sn-activity-stream-queries/latest/index.jsdbx',
					'/uxasset/externals/@servicenow/now-activity-stream/index.jsdbx',
					'/uxasset/externals/@servicenow/now-activity-stream-common/index.jsdbx',
					'/uxasset/externals/sn-oe-sfs/index.jsdbx',
					'/uxasset/externals/@servicenow/now-list-menu/index.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/ongoing.jsdbx',
					'/uxasset/externals/moment/2.29.1/dist/locale/cs.jsdbx',
					'/uxasset/externals/moment/2.29.1/dist/locale/nl.jsdbx',
					'/uxasset/externals/moment/2.29.1/dist/locale/et.jsdbx',
					'/uxasset/externals/moment/2.29.1/dist/locale/fi.jsdbx',
					'/uxasset/externals/moment/2.29.1/dist/locale/fr.jsdbx',
					'/uxasset/externals/moment/2.29.1/dist/locale/de.jsdbx',
					'/uxasset/externals/moment/2.29.1/dist/locale/he.jsdbx',
					'/uxasset/externals/moment/2.29.1/dist/locale/hu.jsdbx',
					'/uxasset/externals/moment/2.29.1/dist/locale/it.jsdbx',
					'/uxasset/externals/moment/2.29.1/dist/locale/ja.jsdbx',
					'/uxasset/externals/moment/2.29.1/dist/locale/ko.jsdbx',
					'/uxasset/externals/moment/2.29.1/dist/locale/pl.jsdbx',
					'/uxasset/externals/moment/2.29.1/dist/locale/pt.jsdbx',
					'/uxasset/externals/moment/2.29.1/dist/locale/ru.jsdbx',
					'/uxasset/externals/moment/2.29.1/dist/locale/es.jsdbx',
					'/uxasset/externals/moment/2.29.1/dist/locale/th.jsdbx',
					'/uxasset/externals/moment/2.29.1/dist/locale/tr.jsdbx',
					'/uxasset/externals/sn-components-omnichannel-interaction/index.jsdbx',
					'/uxasset/externals/now-chat-window/index.jsdbx',
					'/uxasset/externals/@devsnc/sn-tab-filter/index.jsdbx',
					'/uxasset/externals/@devsnc/sn-ui-menu-util/index.jsdbx',
					'/uxasset/externals/sn-connected-chat/index.jsdbx',
					'/uxasset/externals/@devsnc/sn-search-combobox/index.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/circleQuestion.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/bell.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/thumbtack.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/globe.jsdbx',
					'/uxasset/externals/locale-code/latest/index.jsdbx',
					'/uxasset/externals/@devsnc/sn-search-result-evam-card/index.jsdbx',
					'/uxasset/externals/marked/latest/index.jsdbx',
					'/uxasset/externals/tld-list/latest/index.jsdbx',
					'/uxasset/externals/moment-timezone/latest/index.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/caretDown.jsdbx',
					'/uxasset/externals/@devsnc/sn-help-panel/index.jsdbx',
					'/uxasset/externals/@devsnc/sn-search-results-container/index.jsdbx',
					'/uxasset/externals/@servicenow/now-data-set/index.jsdbx',
					'/uxasset/externals/@servicenow/now-data-row/index.jsdbx',
					'/uxasset/externals/@devsnc/sn-evam-resolver/latest/index.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/tag.jsdbx',
					'/uxasset/externals/@devsnc/sn-multi-record-associator/index.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/recordActivityDetails.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/recordActivityStream.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/recordActivity.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/sliders.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/filter.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/sortDescending.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/lock.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/graduationCap.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/paperclip.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/userGroup.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/chevronUp.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/asterisk.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/circleInfo.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/listHide.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/sync.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/squareShare.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/arrowLeftMost.jsdbx',
					'/uxasset/externals/sn-component-workspace-shn/index.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/shoppingCart.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/arrowLeft.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/arrowRight.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/gridVertical.jsdbx',
					'/uxasset/externals/nds-megabundle/icons/arrowRightMost.jsdbx',
					'/uxasset/externals/polaris-app-shell/components/sn-polaris-layout/transaction-status-message/index.jsdbx',
					'/uxasset/externals/@servicenow/sn-banner-announcement/index.jsdbx'
				];
				var prefetchedAssets = prefetchedAssetsStr ? prefetchedAssetsStr.split(',') : defaultPrefetchedAssets;
				prefetchedAssets.unshift('/uxasset/set-cache-buster/' + cacheBuster + '.js');
				var staticPageFragmentUrls = '/uxpf/en/76a83a645b122010b913030a1d81c780.jsdbx?uxpcb=1715272537078,/uxpf/en/f51912f4c700201072b211d4d8c26010.jsdbx?uxpcb=1715272537078,/uxpf/en/1239fbd6070c20105fca5d1aead300ff.jsdbx?uxpcb=1715272537078,/uxpf/en/d4d3a42dc7202010099a308dc7c2602b.jsdbx?uxpcb=1715272537078'.split(',');
				staticPageFragmentUrls.forEach(function(url) {
					if (url) {
						prefetchedAssets.push(url);
					}
				});
				prefetchedAssets.push("/uxsp/all.jsdbx?uxpcb=Pdsm31nJ3ggyHHG63Bt/tAI4RGI=");

				if (navigator.serviceWorker) {
					navigator.serviceWorker.onmessage = function(event) {
						if (event.data === 'SERVICE_WORKER_ACTIVATED') {
							var UX_ASSET_PREFIX = '/uxasset/externals/';
							prefetchedAssets.map(function(url) {
								if (url.startsWith(UX_ASSET_PREFIX)) {
									return assetPublicPath + url.substring(UX_ASSET_PREFIX.length);
								}
								return url;
							}).forEach(function(url) {
								import(url);
							});

							fontAssets.map(getLinkElementGenerator('font', true))
							.forEach(function(el) {
								if (el)
									document.head.append(el);
							});
						}
					};
				}</script><title>Marshall Service Portal</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"></meta><meta http-equiv="cache-control" content="public"></meta><meta name="viewport" content="initial-scale=1.0"></meta><script type="text/javascript" data-description="globals population">
	window.NOW = window.NOW || {};
	var g_loadTime = new Date();
	var lastActivity = new Date();
	var g_lang = 'en';
	var g_system_lang = 'en';
	var g_enhanced_activated = 'true';
	  var g_popup_timeout = parseInt(100);
	var g_export_warn_threshold = parseInt(10000);
	  var g_event_handler_ids = {};
	var g_event_handlers = [];
	var g_event_handlers_onLoad = [];
	var g_event_handlers_onSubmit = [];
	var g_event_handlers_onChange = [];
	var g_event_handlers_onCellEdit = {};
	var g_event_handlers_localCache = {};
	var g_event_handlers_queryTracking = true;
	var g_user_date_time_format = "MM-dd-yyyy hh:mm:ss a";
	var g_user_date_format = "MM-dd-yyyy";
	var g_user_decimal_separator = ".";
	var g_user_grouping_separator = ",";
	var g_glide_list_separator = ", ";
	var g_allow_field_dependency_for_templates = ("true" === "true");
	var g_tz_offset = -25200000;
	  var g_tz_user_offset = true;
	var g_first_day_of_week = parseInt(1, 10);
	var g_date_picker_first_day_of_week = parseInt(0, 10);
	  var g_full_calendar_edit = true;
	var g_submitted = false;
	var g_max_table_length = 80;
	var g_fontSizePreference = "";
	var g_fontSize = "10pt";
	// use to be the sys_property glide.ui.js_error_notify, hard coded for PRB603998
	var g_jsErrorNotify = "true";
	var g_cancelPreviousTransaction = true;
	var g_text_direction = "ltr";
	var g_glide_list_filter_max_length =  parseInt("0", 10);
	var g_accessibility = false;
	var g_accessibility_tooltips = false;
	var g_accessibility_tooltip_duration = parseInt("10", 10);
	var g_accessibility_visual_patterns = false;
	var g_accessibility_screen_reader_table = false;
	var g_accessibility_date_format = false;
	var g_detail_row = false;
	var g_builddate = "03-06-2024_1225";
	// default values to be used in absence of user preferences are hard coded below
	// as well as in keyboardShortcuts.js and keyboard_preference_changer.xml
	window.g_keyboard_shortcuts = {};
	window.g_keyboard_shortcuts.allow_in_input_fields = false;
	window.g_keyboard_shortcuts.enabled = true;
	window.g_keyboard_shortcuts.global_search = {};
	window.g_keyboard_shortcuts.global_search.enabled = true;
	window.g_keyboard_shortcuts.global_search.key_combination = 'ctrl+alt+g';
	window.g_keyboard_shortcuts.main_frame = {};
	window.g_keyboard_shortcuts.main_frame.enabled = true;
	window.g_keyboard_shortcuts.main_frame.key_combination = 'ctrl+alt+p';
	window.g_keyboard_shortcuts.navigator_toggle = {};
	window.g_keyboard_shortcuts.navigator_toggle.enabled = true;
	window.g_keyboard_shortcuts.navigator_toggle.key_combination = 'ctrl+alt+c';
	window.g_keyboard_shortcuts.navigator_filter = {};
	window.g_keyboard_shortcuts.navigator_filter.enabled = true;
	window.g_keyboard_shortcuts.navigator_filter.key_combination = 'ctrl+alt+f';
	window.g_keyboard_shortcuts.impersonator = {}
	window.g_keyboard_shortcuts.impersonator.enabled = true;
	window.g_keyboard_shortcuts.impersonator.key_combination = 'ctrl+alt+i';
	// The `g_concourse_onmessage_enforce_same_origin` and `g_concourse_onmessage_enforce_same_origin_whitelist` variables
    // do not appear to be used anywhere other than the CustomEventManager, but leaving these for backwards compatability
	var g_concourse_onmessage_enforce_same_origin = 'true'.toLowerCase() === 'true';
	var g_concourse_onmessage_enforce_same_origin_whitelist = '';
	window.g_load_functions = [];
	window.g_render_functions = [];
	window.g_late_load_functions = [];
	window.g_tiny_url = {};
	window.g_tiny_url.use_tiny = 'true' === 'true';
	window.g_tiny_url.min_length = parseInt('1024');
	
	
	var g_ck = '6c0ebcabdb0a0a908a4c7504e29619e2488acf77735a71957ebc28e2ac2134f2a4642884';
	

	
	var g_acWaitTime = parseInt(250);
	

	var g_autoRequest = '';

	try {
		window.NOW.dateFormat = JSON.parse("{\"timeAgo\": false, \"dateBoth\": false}");
	} catch (e) {
		window.NOW.dateFormat = {timeAgo: false, dateBoth: false};
	}

	window.NOW.dateFormat.dateStringFormat = "MM-dd-yyyy";
	window.NOW.dateFormat.timeStringFormat = "hh:mm:ss a";
	window.NOW.shortDateFormat = false;
	window.NOW.listTableWrap = true;
	window.NOW.compact = false;
  	window.NOW.templateToggle = false;
	window.NOW.tabbed = true;
	window.NOW.permalink = true;
	window.NOW.useSimpleStorage = true;
	window.NOW.httpRequestCompressionThreshold = 40000;
	window.NOW.httpRequestCompressionLevel = -1;
	window.NOW.httpRequestCompressionMemoryLevel = -1;
	window.NOW.httpRequestCompressionExcludeUrls = 'xmlhttp.do'.split(',');
	window.NOW.deferAmbConnection = false;
	window.NOW.deferredAmbConnectionTimeout = 10000;
	window.NOW.simpleStorageSynch = "4de00233db2102108a4c7504e296196b";
	window.NOW.language =  'en';
	window.NOW.listOpenInAppTab = false;
	window.NOW.floatingScrollbars = false;
	
	window.NOW.user = {};
	window.NOW.user.preferences = [];
	window.NOW.user.roles = 'timeline_user,ais_admin,catalog_builder_editor,flow_designer,catalog_template_editor,catalog,it_project_portfolio_user,cmdb_ms_editor,ml_admin,report_group,pps_resource,viz_creator,app_service_user,dashboard_admin,timecard_user,idea_manager,search_application_admin,flow_operator,search_relevancy_model_admin,cmdb_query_builder_read,workspace_user,sn_cmdb_user,project_manager,catalog_admin,knowledge,it_demand_user,project_portfolio_user,timecard_approver,baseline_user,pa_viewer,sn_sow.sow_user,skill_user,snc_platform_rest_api_access,portfolio_manager,sn_sttrm_condition_read,financial_mgmt_user,task_editor,cmdb_query_builder,live_feed_admin,personalize_dictionary,evam_admin,certification,canvas_user,project_user,pa_data_collector,agent_workspace_user,report_user,resource_user,sn_bm_client.benchmark_data_viewer,tracked_file_reader,view_changer,sn_cmdb_editor,sn_employee.admin,assessment_admin,it_demand_manager,itil,taxonomy_admin,itfm_planner,catalog_lookup_admin,planning_console_user,admin,chat_admin,fiscal_calendar_user,cmdb_ms_user,it_project_user,sn_ace.ace_user,actsub_user,email_client_template_read,decision_table_reader,analytics_filter_admin,sn_hr_sp.esc_admin,sn_templated_snip.template_snippet_admin,knowledge_admin,rate_model_user,email_composer,sn_hr_sp.admin,sn_templated_snip.template_snippet_writer,sp_admin,announcement_admin,sn_templated_snip.template_snippet_reader,template_read_global,interaction_agent,user_criteria_admin,demand_user,data_manager_user,image_admin,it_portfolio_manager,demand_manager,cmdb_read,dependency_views,it_project_manager';
	window.NOW.user.allRoles = 'timeline_user,ais_admin,catalog_builder_editor,flow_designer,catalog_template_editor,catalog,it_project_portfolio_user,cmdb_ms_editor,ml_admin,report_group,pps_resource,viz_creator,app_service_user,dashboard_admin,timecard_user,idea_manager,search_application_admin,flow_operator,search_relevancy_model_admin,cmdb_query_builder_read,workspace_user,sn_cmdb_user,project_manager,catalog_admin,knowledge,it_demand_user,project_portfolio_user,timecard_approver,baseline_user,pa_viewer,sn_sow.sow_user,skill_user,snc_platform_rest_api_access,portfolio_manager,sn_sttrm_condition_read,financial_mgmt_user,task_editor,cmdb_query_builder,live_feed_admin,personalize_dictionary,evam_admin,certification,canvas_user,project_user,pa_data_collector,agent_workspace_user,report_user,resource_user,sn_bm_client.benchmark_data_viewer,tracked_file_reader,view_changer,sn_cmdb_editor,sn_employee.admin,assessment_admin,it_demand_manager,itil,taxonomy_admin,itfm_planner,catalog_lookup_admin,planning_console_user,admin,chat_admin,fiscal_calendar_user,cmdb_ms_user,it_project_user,sn_ace.ace_user,actsub_user,email_client_template_read,decision_table_reader,analytics_filter_admin,sn_hr_sp.esc_admin,sn_templated_snip.template_snippet_admin,knowledge_admin,rate_model_user,email_composer,sn_hr_sp.admin,sn_templated_snip.template_snippet_writer,sp_admin,announcement_admin,sn_templated_snip.template_snippet_reader,template_read_global,interaction_agent,user_criteria_admin,demand_user,data_manager_user,image_admin,it_portfolio_manager,demand_manager,cmdb_read,dependency_views,it_project_manager';
	window.NOW.user.userID = '9f0f93bedb6a08106dbece61399619d0';
	window.NOW.user.departmentID = 'db72e6c247448a1037b8775f746d4375';
	window.NOW.user.firstName = 'Menna';
	window.NOW.user.lastName = 'Kearns';
	window.NOW.user.name = 'megankea';
  	window.NOW.user.isImpersonating = false;
	window.NOW.batch_glide_ajax_requests = 'true' === 'true';
	window.NOW.batch_glide_ajax_requests_max_time_in_queue = ~~'50';
	window.NOW.batch_glide_ajax_disable_time = ~~'1000';

	window.NOW.currency = {};
	window.NOW.currency.code = 'USD';
	window.NOW.locale = {};
	window.NOW.locale.code = 'en_US';

	window.NOW.attachment = {};
	
	window.NOW.attachment.overflow_limit =  parseInt('3', 10);
	window.NOW.isPolarisEnabled = "true";
	window.NOW.polaris_page_info ={"canUsePolarisCSS":true,"canUsePolarisTemplates":true,"jvar_form_name":"ui_page_render"};</script><script data-comment="GlideUser initialization">(function() {
		 g_render_functions.push(setGlideUser);
		function setGlideUser() {
			if (window.g_user || !window.GlideUser)
		return;

		window.g_user = new GlideUser(NOW.user.name,
			  NOW.user.firstName,
			  NOW.user.lastName,
			  NOW.user.roles,
			  NOW.user.userID,
			  NOW.user.departmentID);
		window.g_user.setRoles(NOW.user.allRoles, true);
		}
	})();</script><script data-comment="Fiscal schedule constants">window.NOW.filter_globals = "[[\"This fiscal month\", \"javascript:gs.beginningOfThisSchedulePeriod(\'\',\'This fiscal month\')\", \"javascript:gs.endOfThisSchedulePeriod(\'\',\'This fiscal month\')\", \"javascript:gs.endOfThisSchedulePeriod(\'\',\'This fiscal month\')\"], [\"Last fiscal month\", \"javascript:gs.beginningOfLastSchedulePeriod(\'\',\'Last fiscal month\')\", \"javascript:gs.endOfLastSchedulePeriod(\'\',\'Last fiscal month\')\", \"javascript:gs.endOfLastSchedulePeriod(\'\',\'Last fiscal month\')\"], [\"Next fiscal month\", \"javascript:gs.beginningOfNextSchedulePeriod(\'\',\'Next fiscal month\')\", \"javascript:gs.endOfNextSchedulePeriod(\'\',\'Next fiscal month\')\", \"javascript:gs.endOfNextSchedulePeriod(\'\',\'Next fiscal month\')\"], [\"Last 3 fiscal months\", \"javascript:gs.beginningOfSchedulePeriodsAgo(3, \'\',\'Last 3 fiscal months\')\", \"javascript:gs.endOfSchedulePeriodsAgo(1, \'\',\'Last 3 fiscal months\')\", \"javascript:gs.beginningOfSchedulePeriodsAgo(3, \'\',\'Last 3 fiscal months\')\"], [\"Last 12 fiscal months\", \"javascript:gs.beginningOfSchedulePeriodsAgo(12, \'\',\'Last 12 fiscal months\')\", \"javascript:gs.endOfSchedulePeriodsAgo(1, \'\',\'Last 12 fiscal months\')\", \"javascript:gs.beginningOfSchedulePeriodsAgo(12, \'\',\'Last 12 fiscal months\')\"], [\"Next 3 fiscal months\", \"javascript:gs.beginningOfSchedulePeriodsAgo(-1, \'\',\'Next 3 fiscal months\')\", \"javascript:gs.endOfSchedulePeriodsAgo(-3, \'\',\'Next 3 fiscal months\')\", \"javascript:gs.endOfSchedulePeriodsAgo(-3, \'\',\'Next 3 fiscal months\')\"], [\"Next 12 fiscal months\", \"javascript:gs.beginningOfSchedulePeriodsAgo(-1, \'\',\'Next 12 fiscal months\')\", \"javascript:gs.endOfSchedulePeriodsAgo(-12, \'\',\'Next 12 fiscal months\')\", \"javascript:gs.endOfSchedulePeriodsAgo(-12, \'\',\'Next 12 fiscal months\')\"], [\"This fiscal quarter\", \"javascript:gs.beginningOfThisSchedulePeriod(\'\',\'This fiscal quarter\')\", \"javascript:gs.endOfThisSchedulePeriod(\'\',\'This fiscal quarter\')\", \"javascript:gs.endOfThisSchedulePeriod(\'\',\'This fiscal quarter\')\"], [\"Last fiscal quarter\", \"javascript:gs.beginningOfLastSchedulePeriod(\'\',\'Last fiscal quarter\')\", \"javascript:gs.endOfLastSchedulePeriod(\'\',\'Last fiscal quarter\')\", \"javascript:gs.endOfLastSchedulePeriod(\'\',\'Last fiscal quarter\')\"], [\"Last 4 fiscal quarters\", \"javascript:gs.beginningOfSchedulePeriodsAgo(4, \'\',\'Last 4 fiscal quarters\')\", \"javascript:gs.endOfSchedulePeriodsAgo(1, \'\',\'Last 4 fiscal quarters\')\", \"javascript:gs.beginningOfSchedulePeriodsAgo(4, \'\',\'Last 4 fiscal quarters\')\"], [\"Next fiscal quarter\", \"javascript:gs.beginningOfNextSchedulePeriod(\'\',\'Next fiscal quarter\')\", \"javascript:gs.endOfNextSchedulePeriod(\'\',\'Next fiscal quarter\')\", \"javascript:gs.endOfNextSchedulePeriod(\'\',\'Next fiscal quarter\')\"], [\"Next 4 fiscal quarters\", \"javascript:gs.beginningOfSchedulePeriodsAgo(-1, \'\',\'Next 4 fiscal quarters\')\", \"javascript:gs.endOfSchedulePeriodsAgo(-4, \'\',\'Next 4 fiscal quarters\')\", \"javascript:gs.endOfSchedulePeriodsAgo(-4, \'\',\'Next 4 fiscal quarters\')\"], [\"This fiscal year\", \"javascript:gs.beginningOfThisSchedulePeriod(\'\',\'This fiscal year\')\", \"javascript:gs.endOfThisSchedulePeriod(\'\',\'This fiscal year\')\", \"javascript:gs.endOfThisSchedulePeriod(\'\',\'This fiscal year\')\"], [\"Last fiscal year\", \"javascript:gs.beginningOfLastSchedulePeriod(\'\',\'Last fiscal year\')\", \"javascript:gs.endOfLastSchedulePeriod(\'\',\'Last fiscal year\')\", \"javascript:gs.endOfLastSchedulePeriod(\'\',\'Last fiscal year\')\"], [\"Next fiscal year\", \"javascript:gs.beginningOfNextSchedulePeriod(\'\',\'Next fiscal year\')\", \"javascript:gs.endOfNextSchedulePeriod(\'\',\'Next fiscal year\')\", \"javascript:gs.endOfNextSchedulePeriod(\'\',\'Next fiscal year\')\"]]" || "[]";</script><script data-description="NOW glide web analytics siteid and url">window.snWebaConfig = window.snWebaConfig || {};
		// glide web analytics config
		window.snWebaConfig.siteId = "0";
		window.snWebaConfig.trackerURL = "";
		window.snWebaConfig.webaScriptPath = "/scripts/piwik-3.1.1/thirdparty/piwik.min.js";
		window.snWebaConfig.ambClient = (window.g_ambClient) ? window.g_ambClient : ((window.amb)? window.amb.getClient(): "");
		window.snWebaConfig.subscribed = false;</script><script type="text/javascript" src="/ConditionalFocus.jsdbx?v=03-06-2024_1225&amp;c=18_236"></script><script data-description="UX Metrics Data">(function () {
				try {
					window.NOW = window.NOW || {};
					window.NOW.UXMetrics = window.NOW.UXMetrics || {};
					var config = '{"subscribers":[{"path":"/uxasset/externals/@devsnc/ux-metrics-appsee-subscriber/index.jsdbx","config":{"apiAuth":"967a6e487c944d99b864ee0b5ca115c1","apiKey":"665705f86f2e2540869e7b2f5d3ee465:635911e2732130107d804c9885f6a78f","endpointURL":"https://api-appsee.service-now.com","restrictedApps":"","allowedPropsInPageNavigate":"Entry Page,Page Title","enableUnauthenticatedUserTracking":"false","channelType":"NextExperience","trackingConsent":"Full","user":{"domainName":"global","roles":"timeline_user,ais_admin,catalog_builder_editor,flow_designer,catalog_template_editor,catalog,it_project_portfolio_user,cmdb_ms_editor,ml_admin,report_group,pps_resource,viz_creator,app_service_user,dashboard_admin,timecard_user,idea_manager,search_application_admin,flow_operator,search_relevancy_model_admin,cmdb_query_builder_read,workspace_user,sn_cmdb_user,project_manager,catalog_admin,knowledge,it_demand_user,project_portfolio_user,timecard_approver,baseline_user,pa_viewer,sn_sow.sow_user,skill_user,snc_platform_rest_api_access,portfolio_manager,sn_sttrm_condition_read,financial_mgmt_user,task_editor,cmdb_query_builder,live_feed_admin,personalize_dictionary,evam_admin,certification,canvas_user,project_user,pa_data_collector,agent_workspace_user,report_user,resource_user,sn_bm_client.benchmark_data_viewer,tracked_file_reader,view_changer,sn_cmdb_editor,sn_employee.admin,assessment_admin,it_demand_manager,itil,taxonomy_admin,itfm_planner,catalog_lookup_admin,planning_console_user,admin,chat_admin,fiscal_calendar_user,cmdb_ms_user,it_project_user,sn_ace.ace_user,actsub_user,email_client_template_read,decision_table_reader,analytics_filter_admin,sn_hr_sp.esc_admin,sn_templated_snip.template_snippet_admin,knowledge_admin,rate_model_user,email_composer,sn_hr_sp.admin,sn_templated_snip.template_snippet_writer,sp_admin,announcement_admin,sn_templated_snip.template_snippet_reader,template_read_global,interaction_agent,user_criteria_admin,demand_user,data_manager_user,image_admin,it_portfolio_manager,demand_manager,cmdb_read,dependency_views,it_project_manager","hashId":"dd6f29ae5ee9a48db1500abadba4ceb4f2fdd99b6fa76837218baa0af49a2474","domainId":"global"},"enabled":"true"}}],"userConsentRequired":false,"globalMetricsLevel":4}';
					if (config) {
						window.NOW.UXMetrics.config = JSON.parse(config);
						window.NOW.UXMetrics.ucmInfo = {
							user_analytics_consent_text: '',
							user_consent : "NoConsentRequired"
						};
					}
				} catch(err) {}
			})();</script><link href="favicon.ico" rel="shortcut icon"></link><script type="text/javascript" src="/scripts/doctype/xperf_timing.jsx?v=03-06-2024_1225"></script><link type="text/css" rel="stylesheet" href="/styles/css_includes_doctype_polaris.cssx?v=03-06-2024_1225&amp;c=bad1ec63db860a908a4c7504e2961998&amp;theme=Polaris"></link><script>window.NOW = window.NOW || {};
		 NOW.isUsingPolaris = true;</script><script type="text/javascript" src="/scripts/polaris_theme_refresh_observer.jsx?v=03-06-2024_1225"></script><link type="text/css" rel="stylesheet" href="/styles/polarisberg/css_includes_polarisberg.cssx?v=03-06-2024_1225&amp;c=bad1ec63db860a908a4c7504e2961998&amp;theme=Polaris"></link><script>NOW.exclude_dark_theme = "false";</script><link type="text/css" rel="stylesheet" href="/polarisberg_theme_variables.do?c=falseu4FhlE2xeZToWgft5ch0P8j2ZlQ%3D" id="polarisberg_theme_variables"></link><script>NOW.xperf.cssEnd = NOW.xperf.now();
			NOW.xperf.scriptBegin = NOW.xperf.now();</script><script src="/legacy_date_time_choices_processor.do?lang=en"></script><script type="text/javascript" src="/scripts/doctype/js_includes_doctype.jsx?v=03-06-2024_1225&amp;lp=Mon_Apr_22_10_01_21_PDT_2024&amp;c=18_236"></script><script type="text/javascript" src="/scripts/js_includes_customer.jsx?v=03-06-2024_1225&amp;lp=Mon_Apr_22_10_01_21_PDT_2024&amp;c=18_236"></script><script type="text/javascript" src="/scripts/doctype/history_across_tabs.jsx?v=03-06-2024_1225"></script><script type="text/javascript" src="/scripts/doctype/js_includes_legacy.jsx?v=03-06-2024_1225&amp;lp=Mon_Apr_22_10_01_21_PDT_2024&amp;c=18_236"></script><script type="text/javascript" data-comment="navpage layout preferences, onfocus observation">/**
	* Every window needs to observe these events.
	*/
	if (Prototype.Browser.IE && !isMSIE9) {
		document.onfocusout = function() { CustomEvent.fireTop(GlideEvent.WINDOW_BLURRED, window); };
		document.onfocusin = function() { CustomEvent.fireTop(GlideEvent.WINDOW_FOCUSED, window); };
	} else {
		Event.observe(window, 'blur', function() { CustomEvent.fireTop(GlideEvent.WINDOW_BLURRED, window); });
		Event.observe(window, 'focus', function() { CustomEvent.fireTop(GlideEvent.WINDOW_FOCUSED, window); });
	}</script><script type="text/javascript">g_swLoadTime = new StopWatch(g_loadTime);

    if (window.CustomEvent){
        CustomEvent.fireAll("ck_updated", "6c0ebcabdb0a0a908a4c7504e29619e2488acf77735a71957ebc28e2ac2134f2a4642884");
	    CustomEvent.fireTop("navigation.complete", window);
	}

    addLoadEvent( function() {

		if (isValidTouchDevice())
			addTouchScrollClassToBody();

      if (typeof g_ck != 'undefined') {
        CustomEvent.observe("ck_updated", function(ck) { g_ck = ck; });
        CustomEvent.fireAll("ck_updated", "6c0ebcabdb0a0a908a4c7504e29619e2488acf77735a71957ebc28e2ac2134f2a4642884");CustomEvent.fireTop('user.impersonation', '');}try {
              var helpico = getTopWindow().document.getElementById("help_ico");

              if (helpico) {
                var urlname=window.location.pathname.split("?");
                var search_str = window.location.search;
                
                // if this is a form, extract the record's sys_id...
                var sys_id_loc = search_str.search(/sys_id=[0-9a-f]{32}/i);
                var sys_id_str = (sys_id_loc != -1) ? search_str.substr(sys_id_loc, 39) : null;
                
                // make the URL to our context help processor...
                var url_search = "?sysparm_url=" + urlname[0];
                if (sys_id_loc != -1)
                   url_search += "&" + sys_id_str;

               	helpico.href="context_help.do" + url_search;                	
              }
            } catch (exception) {}

      synchCache();
      pageLoaded();
    });
    
    function synchCache() {
      try {
        var w = getTopWindow();
        if (w.g_cache_message)
          w.g_cache_message.stamp("4de00233db2102108a4c7504e296196b");
  
        if (w.g_cache_td)
          w.g_cache_td.stamp("fcf98d23db8a0a908a4c7504e296193f");
      } catch(e) {}
    }

    function isValidTouchDevice() {
		var navigator = window.navigator || {};
		var devices;
		try {
			devices = 'iPad,Android'.split(',');
		} catch(ex) {
			devices = [];
		}
		return devices.some(function(item) {return item.trim() === navigator.platform;});
	}

	function addTouchScrollClassToBody() {
		if ('ontouchstart' in window ||
				(navigator.maxTouchPoints !== 'undefined' && navigator.maxTouchPoints > 0) ||
				(navigator.msMaxTouchPoints !== 'undefined' && navigator.msMaxTouchPoints > 0)) {
			if (typeof document.body != undefined) {
				document.body.classList.add('touch_scroll');
			}
		}
	}
  </script><script>window.NOW = window.NOW || {};
        NOW.amb_themed_login = true;</script><script type="text/javascript" src="/scripts/js_includes_amb.jsx?v=03-06-2024_1225&amp;lp=Mon_Apr_22_10_01_21_PDT_2024&amp;c=18_236"></script><!--googleoff: all--><noscript>This site requires JavaScript to be enabled</noscript> <!--googleon: all--><script type="text/javascript" src="/scripts/app.guided_tours/js_guided_tours_includes.jsx?v=03-06-2024_1225"></script><script>NOW.xperf.scriptEnd = NOW.xperf.now();
				NOW.xperf.parseEnd = NOW.xperf.now();</script></head><body class="        chrome        -polaris " data-formName="ui_page_render"><span class="sr-only"><div id="html_page_aria_live_polite" role="region" aria-relevant="additions text" aria-atomic="false" aria-live="polite"></div><div id="html_page_aria_live_assertive" role="region" aria-relevant="additions text" aria-atomic="false" aria-live="assertive"></div></span><div class="outputmsg_div"><div id="output_messages" class="outputmsg_container outputmsg_hide"><button type="button" aria-label="Close Messages" id="close-messages-btn" class="btn btn-icon close icon-cross" onclick="GlideUI.get().onCloseMessagesButtonClick(this); return false;"></button><div class="outputmsg_div" aria-live="polite" role="region" data-server-messages="false"></div></div><script>addRenderEvent(function() {CustomEvent.fire('glide_optics_inspect_update_watchfield', '');});

			var accessibilityEnabled = Boolean(false);
			var hasMessages = false;
			if (accessibilityEnabled && hasMessages) {
				$j(function() {
					$j('#output_messages .btn.btn-icon.close').focus();
				});
			}</script></div><script type="text/javascript" src="/scripts/lib/jquery_includes.jsx?v=03-06-2024_1225"></script><script type="text/javascript" src="/scripts/classes/timeAgo.jsx?v=03-06-2024_1225"></script><link type="text/css" rel="stylesheet" href="/styles/knowledge.ng/css_includes_knowledge_polaris.cssx?v=03-06-2024_1225&amp;c=12-13-2019_12:12:38 PM_bad1ec63db860a908a4c7504e2961998&amp;theme=1db5f185ff200200096fffffffffff1d"></link><link href="e113037c8d995110f877cc1790289d71.cssdbx?v=03-06-2024_1225" type="text/css" rel="stylesheet"></link><script>if('Find and manage duplicate users in SN - SSO Login/LDAP cleanup' != ''){
			$j("title").text(new DOMParser().parseFromString("Internal Knowledge - Find and manage duplicate users in SN - SSO Login/LDAP cleanup", "text/html").documentElement.textContent);
		}
		var kbConfig = {
			canContribute: 'true',
			historyRowCount: 0,
			i18n: {
				STATUS_MSG: {
					draft: 'This knowledge item has been created',
					review: 'This knowledge item has been published',
					published: 'This knowledge item has been published',
					pending_retirement: 'This knowledge item has been retired',
					retired: 'This knowledge item has been retired',
					delete_failed: 'This article could not be deleted'
				},
				TXT_PLACEHOLDER: 'Add content',
				NOT_RETIRED: 'Article not retired',
				NOT_PUBLISHED: 'Article not published',
				NOT_SAVED: 'Article not saved',
				SAVED: 'Article saved',
				DISCARDED: 'Article changes discarded',
				SUBMITTED: 'Your article has been submitted',
				PREVIEW: ' preview ',
				PREVIEW_HINT: 'Preview changes',
				CONFIRM_DELETE: 'Confirm deletion of this article?',
				DELETE: 'Delete',
				TITLE_RETIRE: 'Retire',
				MESSAGE_RETIRE: 'Retire this article?',
				TITLE_CANCEL: 'Cancel changes',
				MESSAGE_CANCEL: 'Discard all changes?'
			}
		};

		$j(function() {
			if (parent.document) {
				// fix iframe resize issue for CMS service portal
				parent.CustomEvent.fire('content_frame.resized', window.name, parent.document.body.scrollHeight);
			}

			if('' != '') {
				if(typeof URL != 'undefined') {
					var url = new URL(window.location.href);
					url.searchParams.set('sysparm_article', '');
					window.history.pushState({path: url.href}, '', url);
				} else {
					// Fallback solution for IE where URL is not defined.
					var replaceQueryParameter = function(parameter, value, search) {
						var regex = new RegExp("([?;&amp;])" + parameter + "[^&amp;]*[;&amp;]?");
						var query = search.replace(regex, "$1").replace(/&amp;$/, '');

						return (query.length > 2 ? query + "&amp;" : "?") + (value ? parameter + "=" + value : '');
					}
		
					var url = window.location.origin + replaceQueryParameter('sysparm_article', '', window.location.search);
					window.history.pushState({path: url}, '', url);
				} 
			}
		});</script><script>// variables for tinymce init
				var g_tinymce_lang = "en";
				var g_tinymce_remove_script_host = true;
				var tinymce_toolbar_line1 = "bold,italic,underline,undo,redo,|,removeformat,formatselect,fontselect,fontsizeselect,table,|,forecolor,backcolor,link,unlink,|,image,media,code,|,alignleft,aligncenter,alignright,|,bullist,numlist,fullscreen";
				var tinymce_toolbar_line2 = "cut,copy,paste,pastetext,searchreplace,|,hr,visualblocks,|,indent,outdent";
				var tinymce_fonts = "Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Journal=journal;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats;";

				addLoadEvent(function() {
					if (typeof g_sc_form == "undefined") if (typeof g_form != "undefined") {
						g_sc_form = g_form;
					}
				});</script><script type="text/javascript" src="/KnowledgeFunctions.jsdbx?v=03-06-2024_1225&amp;c=18_236"></script><script type="text/javascript" src="/KBViewArticle.jsdbx?v=03-06-2024_1225&amp;c=18_236&amp;cache=2024-02-14 10:01:20"></script><div class="snc-article-hidden-fields" aria-hidden="true"><input id="articleId" type="hidden" value="ded8a140dbc2c6508a4c7504e29619d6"></input><input type="hidden" aria-hidden="true" id="ts_queryId" value=""></input><input id="articleWorkflowState" type="hidden" value="published"></input><input id="articleTitleTemplate" type="hidden" value=""></input><input id="articleTemplate" type="hidden" value=""></input><input id="articleTitleOld" type="hidden" value="Find and manage duplicate users in SN - SSO Login/LDAP cleanup"></input><input id="articleOriginal" type="hidden" value="&lt;p&gt;This is a step by step guide to identify users with duplicate active accounts in ServiceNow.&lt;/p&gt;
&lt;p&gt;Issue: We wanted to change SSO login from samaccounname to UPN.&amp;nbsp; However we encountered an issue: many &amp;ldquo;active&amp;rdquo; SN users were not getting updated on import with UPNs. The reason is twofold &amp;ndash; 1) some users are deleted in LDAP and so the SN sys_user table will never get updated, 2) a BR was throwing an error on what it saw as duplicate notification devices (email). In reality, this was mostly due to some users having duplicate accounts, only one which should be active. But the business rule did not account for inactive vs active accounts, hence skipping the user record of the active account. Once we corrected the issue ensuring that all active users in SN were actually active existing users in LDAP, we modified the BR script to allow an update to a user if their account with a duplicate notification device was inactive. This updated the UPNs as well as their emails.&lt;/p&gt;
&lt;p&gt;1) Created a Script Include called &quot;getDuplicates&quot;. We can call this script in the list view of our &quot;sys_user&quot; table in order to filter and find users with duplicate accounts in SN. In our case, we will be looking based on USC ID, as users can have unique emails and UPNs associated with the same USC ID.&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code&gt;var getDuplicates = Class.create();
getDuplicates.prototype = Object.extendsObject(AbstractAjaxProcessor, {
	getDuplicates: function(table, field) {
	var dupRecords = [];
	var gaDupCheck = new GlideAggregate(table);
	gaDupCheck.addAggregate('COUNT', field);
	gaDupCheck.addNotNullQuery(field);
	gaDupCheck.groupBy(field);
	gaDupCheck.addHaving('COUNT', '&amp;gt;', 1);
	gaDupCheck.query();
	while (gaDupCheck.next()) {
	dupRecords.push(gaDupCheck[field].toString());
}
	return dupRecords;
},

type: 'getDuplicates'
});&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2) Use this to filter on the &quot;sys_user&quot; table, where:&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;background-color: #fbeeb8;&quot;&gt;USC ID Number is javascript:new global.getDuplicates().getDuplicates('sys_user', 'u_uscid_number')&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;padding-left: 40px;&quot;&gt;a) Save this filter to access it easily for future reference (ex: getDupes). &lt;span dir=&quot;ltr&quot;&gt;Click on the filter icon, and save the filter. You can then choose to save to yourself, your group, or everyone:&lt;/span&gt;&lt;/p&gt;
&lt;p style=&quot;padding-left: 40px;&quot;&gt;&lt;img src=&quot;/sys_attachment.do?sys_id=9505bb30dbc2ca508a4c7504e29619d0&quot; alt=&quot;&quot; width=&quot;898&quot; height=&quot;467&quot; data-library=&quot;false&quot; /&gt;&lt;/p&gt;
&lt;p style=&quot;padding-left: 40px;&quot;&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;3) Once we filter on duplicate users associated with the same USC ID, we can further filter out users based on &quot;memberof&quot;, &quot;dn&quot;, or excluding terms like &quot;test&quot;.&lt;/p&gt;
&lt;p&gt;4) In order to perform a cleanup of duplicate users and disable the ones we do not use, we create a new LDAP import set table of all users &quot;Marshall LDAP Cleanups&quot;, not broken up by OU. Run this directly from the Data Source &quot;Marshall LDAP Cleanup&quot; (note the LDAP target's OU Definition &quot;LDAP User's Cleanup&quot; contains no RDN). The transform map &quot;LDAP Cleanup Temp Users Import&quot; maps the fields from our import set table into our ServiceNow table &quot;LDAP Temp Users&quot;, which we will use to run against our &quot;sys_user&quot; table in our disabling script.&lt;/p&gt;
&lt;p&gt;Steps to achieve this outcome are:&lt;/p&gt;
&lt;ol style=&quot;list-style-position: inside;&quot;&gt;
&lt;li&gt;Add new UPN field map to user table (sys_user)&lt;/li&gt;
&lt;li&gt;Add UPN field to existing LDAP table transform maps (mapping assist)&lt;/li&gt;
&lt;li&gt;Create new system table &amp;ldquo;LDAP Temp Users&amp;rdquo; with necessary dictionary entries (active, usc id, user id, etc)&lt;/li&gt;
&lt;li&gt;LDAP import process for new import set table &amp;ldquo;Marshall LDAP Cleanup&amp;rdquo;:
&lt;ol style=&quot;list-style-type: lower-alpha; list-style-position: inside;&quot;&gt;
&lt;li&gt;New OU definition&lt;/li&gt;
&lt;li&gt;New Data Source&lt;/li&gt;
&lt;li&gt;New Table transform map&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This populates our new system table LDAP Temp Users.&lt;/p&gt;
&lt;p&gt;5) Created a Fix Script that compares active SN users in the &quot;sys_user&quot; table against non-existent users in the LDAP import &quot;Deactivate accounts deleted from AD&quot;, and run to disable them. This script is looking at our &quot;LDAP Temp Users&quot; table and if a user does not exist there, but is found in the User table, disable it and make it inactive.&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code&gt;// Query the main users table (sys_users)
var mainUsers = new GlideRecord('sys_user');
mainUsers.query();

while (mainUsers.next()) {
    var mainUserSamAccount = mainUsers.getValue('user_name');
    
    // Query the temp users table (u_ldap_temp_user) for the current main user's samaccountname
    var tempUsers = new GlideRecord('u_ldap_temp_user');
    tempUsers.addQuery('u_user_name', mainUserSamAccount);
    tempUsers.query();
    
    // If no corresponding record is found in temp users table, update attributes in main users table
    if (!tempUsers.next()) {
        mainUsers.setValue('active', false);
        mainUsers.setValue('locked_out', true);
        mainUsers.update();
    }
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;6) Update BR to allow update of users who have a duplicate notification device on an inactive account record.&lt;/p&gt;
&lt;p&gt;7) Manually run LDAP import sets to update remaining records&lt;/p&gt;
&lt;p&gt;8) Once the above is complete and we have a clean sys_user table, we can upload our second update set, which just sets the coalesce on UPN.&lt;/p&gt;"></input><input id="articleTextType" type="hidden"></input><textarea id="articleWikiText" style="display:none" aria-label="Article wiki text"></textarea><input id="articleInPopUp" type="hidden" value="false"></input><input id="articleDirty" type="hidden" value="Changes have been made. Continuing will discard the changes."></input><input id="articleIsNew" type="hidden"></input><input id="articleModified" type="hidden" value="false"></input><input id="articleEditMode" type="hidden" value="false"></input><input id="articleVersion" type="hidden" value="3"></input><input id="articleDisplayAttachments" type="hidden" value="false"></input><input id="articleShowKBCreateIncident" type="hidden" value="true"></input><input id="articleVersioningInstalled" type="hidden" value="true"></input><input id="articleKnowledgeBase" type="hidden" value="5bf4f1e20f500300aaa549bce1050e63"></input><input id="articleKnowledgeBaseName" type="hidden" value="Internal Knowledge"></input><input id="articleNumber" type="hidden" value="KB0000946"></input><input id="createIncidentLinkLocation" type="hidden" value="incident.do?sys_id=-1&amp;sysparm_query=active=true^comments=(Created after Knowledge search: Find%20and%20manage%20duplicate%20users%20in%20SN%20-%20SSO%20Login%2FLDAP%20cleanup)&amp;sysparm_stack=knowledge_home_launcher.do"></input><input id="attachFields" type="hidden" value="comments"></input><input id="canShowKBFeedback" type="hidden" value="true"></input><input id="isLiveFeedEnabled" type="hidden" value="true"></input></div><div class="row navbar navbar-default snc-article-header-toolbar" role="navigation"><div class="col-xs-7 kb-container-fluid"><div class="row kb-navbar-header"><div class="col-xs-2 head-back-n-star"><button role="link" id="backButton" title="Back" aria-label="Back" class="btn btn-default icon-chevron-left navbar-btn snc-article-toolbar-btn pull-left"></button>
	
	<div class="modal" id="createFavoritesModal" aria-labelledby="favorite_modal_title" name="create_favorites_modal" role="dialog">
		<div class="modal-dialog modal-md">
			<div class="modal-content">
				<header class="modal-header clearfix">
					<button data-dismiss="modal" class="btn btn-icon close icon-cross">
						<span class="sr-only">Close</span></button>
					<h2 id="favorite_modal_title" class="modal-title pull-left h4">Create Favorite</h2></header>
				<form class="create-favorite" name="create_favorite_form">
					<div class="modal-body clearfix">
					<div id="output_messages_favorite" class="outputmsg_container outputmsg_hide compact">
						<button aria-label="Close Messages" class="btn btn-icon close icon-cross"></button>
						<div class="outputmsg_div" aria-live="polite" role="region" data-server-messages="false"></div></div>
						<div id="favorite_preview"><span></span></div>
						<label class="sr-only" for="create_favorite_title" aria-labelledby="create_favorite_title">Bookmark title</label>
						<input type="text" id="create_favorite_title" name="title" class="form-control" value="" aria-label="Bookmark title" aria-required="true" aria-invalid="false" placeholder="Bookmark title"></input>
						<input type="hidden" name="url" value=""></input>
						<input type="hidden" name="window_name" value=""></input>
						<input type="hidden" name="id" value=""></input>
						<input type="hidden" name="color" value=""></input>
						<div class="color-picker">
							<fieldset id="icon_colors">
								<legend class="sr-only">Color</legend></fieldset></div>
						<input type="hidden" name="icon" value=""></input>
						<div class="icon-picker">
							<fieldset id="icon_picker" class="nav-edit-favorites-icon-grid">
								<legend class="sr-only">Icon</legend></fieldset></div></div>
					<div class="modal-footer">
						<button data-dismiss="modal" type="button" class="btn btn-default">Cancel</button>
						<button type="submit" class="btn btn-primary">Done</button></div></form>
				<script type="text/javascript">
					
						window.MagellanCreateFavorites = {
							navColors : ["purple","blue","cyan","aquamarine","green","yellow","orange","burnt-orange","red","pink","fuschia","white"],
							navIcons : ["article-document","user","user-group","lightbulb","home","mobile","comment","mail","locked","database","book","drawer","folder","catalog","tab","cards","tree-right","tree","book-open","paperclip","edit","trash","image","search","power","cog","star","star-empty","new-ticket","dashboard","cart-full","view","label","filter","calendar","script","add","delete","help","check-circle","alert","sort-ascending","console","list","form","livefeed","key","hr"],
							paramBlackList : ["sysparm_no_stack","sysparm_userpref_module","sysparm_record_target","sysparm_record_row","sysparm_record_rows","sysparm_record_list"]
						};
					</script>
				<script type="text/javascript" src="/scripts/thirdparty/radio/radioButton.jsx?v=03-06-2024_1225"></script>
				<script type="text/javascript" src="/scripts/thirdparty/radio/radioGroup.jsx?v=03-06-2024_1225"></script>
				<script type="text/javascript" src="/scripts/magellan.CreateFavoriteModal.jsx?v=03-06-2024_1225"></script></div></div></div><script>(function() {
									var historyData = {
										title: 'Find and manage duplicate users in SN - SSO Login/LDAP cleanup',
										isTable: false,
										url: '/kb_view.do?sysparm_article=KB0000946'
									};
									CustomEvent.fire('magellanNavigator.sendHistoryEvent', historyData);
								})();
								function showCreateFavoriteModal() {
									if (MagellanCreateFavorites && MagellanCreateFavorites.addFavorite) {
										MagellanCreateFavorites.addFavorite({
										title : 'Find and manage duplicate users in SN - SSO Login/LDAP cleanup',
										icon : 'book',
										url: '/kb_view.do?sysparm_article=KB0000946'
									});
									}
								}</script><button onclick="showCreateFavoriteModal()" class="btn btn-icon icon-star pull-left" title="Create Favorite" aria-label="Create Favorite"></button></div><div class="col-xs-10 head-bc"><ol class="breadcrumb kb_view_breadcrumb"><li><a href="knowledge_home_launcher.do">Home</a></li><li><a href="knowledge_home_launcher.do?sysparm_kb=5bf4f1e20f500300aaa549bce1050e63&amp;sysparm_category=012fbe3e0f900300988f0bcce1050efa&amp;browse_type=categories">ServiceNow</a></li></ol></div></div></div><div class="col-xs-5 snc-kb-navbar-right"><div class="header-bar-btn-group" id="header-bar-button-group"><button id="subscribeArticle" title="Subscribe Article" class="btn btn-default snc-article-header-toolbar-button-hide snc-article-header-toolbar-button-subscription navbar-btn pull-right">Subscribe</button><button id="unsubscribeArticle" title="Unsubscribe Article" class="btn btn-default snc-article-header-toolbar-button-subscription navbar-btn pull-right"><span class="subscribed">Subscribed</span><span class="unsubscribe">Unsubscribe</span></button><button id="flagArticle" title=" Flag Article " aria-label=" Flag Article " class="btn btn-default navbar-btn snc-article-header-toolbar-button pull-right">Flag Article</button><button id="createIncident" title="Create Incident" aria-label="Create Incident" class="btn btn-default navbar-btn snc-article-header-toolbar-button pull-right">Create Incident</button><button id="moreInformation" title="Information" aria-label="Information" class="btn btn-default navbar-btn snc-article-header-toolbar-button pull-right"><span class="icon icon-view"></span></button><button role="link" id="editArticle" style="margin-left:0.4em;" title="Edit content" aria-label="Edit content" class="btn btn-default navbar-btn snc-article-header-toolbar-button pull-right">Edit</button></div></div></div><div id="kb_confirmationDlg" tabindex="-1" aria-hidden="true" class="modal" role="dialog" aria-labelledby="modal1_title"><div class="modal-dialog modal-sm modal-alert"><div class="modal-content" tabindex="0" aria-label="Cancel changes confirmation dialog"><header class="modal-header"><h4 id="modal1_title" class="modal-title">Cancel changes</h4></header><div class="modal-body" tab-index="0" aria-label="Discard all changes?" aria-role="question"><p>Discard all changes?</p></div><footer class="modal-footer flex"><button data-dismiss="modal" aria-label="No" class="btn btn-default kb-no-btn" onclick="$j('#kb_confirmationDlg').hide()">No</button><button data-dismiss="modal" aria-label="Yes" class="btn btn-danger kb-yes-btn">Yes</button></footer></div></div></div><div id="unSubscribe" aria-hidden="true" class="modal" role="dialog" aria-labelledby="modal2_title"><div class="modal-dialog modal-sm"><div class="modal-content"><header class="modal-header"><h4 id="modal2_title" class="modal-title">Unsubscribe</h4></header><div class="modal-body"><p>In order to unsubscribe from this article, you will need to unsubscribe from the parent Knowledge Base: Internal Knowledge.</p><p><b>Would you like to unsubscribe from Internal Knowledge ?</b></p></div><footer class="modal-footer flex"><button data-dismiss="modal" class="btn btn-default kb-no-btn">No</button><button id="unsubscribeDialog" data-dismiss="modal" class="btn btn-primary kb-yes-btn">Yes</button></footer></div></div></div><div class="kb-view-content-wrapper"><div id="messageBox" class="snc-article-header-message outputmsg_container" aria-live="assertive" role="alert"><div class="outputmsg_div"><div id="messageType" class="outputmsg outputmsg_info notification notification-info" style="width:100%; display:inline-flex;" role="status"><div style="width:100%;" id="ariaNotification"><img class="outputmsg_image" id="info_outputmsg_image" title="Informational Message" aria-label="Informational Message" src="images/outputmsg_info_24.gifx"></img><span id="articleText" class="outputmsg_text"></span></div><button id="closeMessageBox" title="Close Messages" class="btn btn-icon close icon-cross" onclick="$j('#messageBox').hide()"><span class="sr-only">Close Messages</span></button></div></div></div><script>document.getElementById("info_outputmsg_image").setAttribute('alt', "Informational Message");</script><div class="snc-article-header-title"><input id="articleTitleEditable" type="text" aria-label="Article title" value="Find and manage duplicate users in SN - SSO Login/LDAP cleanup" class="snc-article-header-title-editable" placeholder="Add title" style="display:none" autofocus="true"></input><h1 id="articleTitleReadonly" class="snc-article-header-title-readonly" style="display:none">Find and manage duplicate users in SN - SSO Login/LDAP cleanup</h1><div id="articleNumberReadonly" class="snc-article-header-number-readonly" style="display:none">KB0000946</div></div><script>
				function KbStarRatingClass() {
					var currentId = 'ded8a140dbc2c6508a4c7504e29619d6';
					var currentRating = 0;
					function ajaxPost(value) {
						if (currentId) {
							var ajax = new GlideAjax('KBAjax');
							ajax.addParam('sysparm_type', 'saveStarRating');
							ajax.addParam('sysparm_rating', value);
							ajax.addParam('sysparm_id', currentId);
							var query = $j('#sysparm_search');
							var ts_queryId = "";
							ajax.addParam('sysparm_search', (query.length) ? escape(query.val()) : '');
							ajax.addParam("ts_queryId", ts_queryId);
							ajax.getXMLAnswer(postRatingDone);
						}
					}
					function postRatingDone(answer){
						var data = answer.evalJSON(true);
						if (!data) {
							return kbViewArticle.showErrorMessage('Article rating not submitted');
						}
						if (!data.success) {
							return kbViewArticle.showErrorMessage(data.message);
						}
					}
					function setStarsRating(value) {
						if (!isNaN(value)) {
							currentRating = Math.round(value);
						}
						if (currentRating > 0) {
							var ratingMessage = getUIMessage([currentRating]);
							$j('#articleStarRatingGroup').attr("title", ratingMessage);
							$j('#articleStarRatingGroup').attr("data-original-title", ratingMessage);
							$j('.kb-star-rating label').filter(function() {
							return $j(this).attr('data-index') <= currentRating;
							}).addClass('kb-active-star');
							if(this.selfRated) {
								$j('.kb-star-rating label.kb-active-star').addClass('kb-active-star-self').removeClass('kb-active-star');
							}
						}
						else{
								var message = "This article has not been rated yet. Use up and down arrow keys to select and submit the rating.";
								
								$j('#articleStarRatingGroup').attr("title", message);
								$j('#articleStarRatingGroup').attr("data-original-title", message);
						}
					}
					function saveRating(value) {
						ajaxPost(value);
						this.selfRated = true;
					}
					return {
						setStarsRating: setStarsRating,
						saveRating: saveRating
					};
				}
				$j(function() {
					// As the hex values of the Heisenberg icons keep changing it's impossible to reliably set the "content" CSS
					// attribute of the :hover:before pseudo class in the stylesheet in order to display a full star instead of an
					// empty one when hovering over with the mouse.
					// Instead we set the pseudo to fetch its "content" from a "data-content" attribute. (see .kb-star-rating)
					var ele = $j('#placeholder-icon-star')[0];
					if(ele && window.getComputedStyle) {
						var content;
						var contentStyle = getComputedStyle(ele,':before');
						if(!contentStyle) {
							//Happens for FF in popovers
							contentStyle = window.parent.getComputedStyle(ele,':before');
						}
						content = contentStyle.getPropertyValue('content');
						if(content && content != 'none') {
							content = content.replace(/"/g, '');
							$j('.kb-star-rating .icon-star-empty').attr('data-content', content);
						}else if(content == 'none'){
							//This happens for popovers in IE
							useIconStarImageClassess();
						}
					}
					// create an instance
					var kbArticleRating = new KbStarRatingClass();
					kbArticleRating.setStarsRating();
					$j('.kb-star-rating label').click(function (event) {
						var targetIndex = $j(event.currentTarget).attr('data-index');
						kbArticleRating.setStarsRating(targetIndex);
						$j('#rated_value').val(targetIndex);
						kbArticleRating.saveRating(targetIndex);
						updateCurrentStarRatingForAria(targetIndex);
					});
					$j('.kb-star-rating input').on("focus",function(e) {
						var id = e.target.id;
						id = parseInt(id[id.length-1]);
						$j('.kb-star-rating label').filter(function() {
								return $j(this).attr('data-index') <= id;
						}).addClass('kb-hover-star');
					});
					$j('.kb-star-rating input').on("blur",function(e) {
						$j('.kb-star-rating label').removeClass('kb-hover-star');
					});
					$j('.kb-star-rating').on("keydown",function(e) {	
						var id = e.target.id;
						var int_id = parseInt(id[id.length-1]);
						if(e.keyCode == 40) {
							int_id %= 5;
							if(int_id == 0){
								$j(this).find('label').removeClass('kb-hover-star');
							}
							$j('.kb-star-rating label').filter(function() {
								return $j(this).attr('data-index') <= int_id+1;
							}).addClass('kb-hover-star');
						}
						else if(e.keyCode == 38) {
							$j('.kb-star-rating label').filter(function() {
								return $j(this).attr('data-index') >= int_id;
							}).removeClass('kb-hover-star');
							if(int_id == 1){
								$j(this).find('label').addClass('kb-hover-star');
							}
						}
						 else if(e.keyCode == 13) {
							kbArticleRating.setStarsRating(int_id);
							$j('#rated_value').val(int_id);
							kbArticleRating.saveRating(int_id);
							updateCurrentStarRatingForAria(int_id);
						}
						else if(e.keyCode == 9) {
							$j(this).find('label').removeClass('kb-hover-star');
						}
					});
					$j('.kb-star-rating').on("mouseenter focusin", function(){
						removeToolTipForRatingParent("remove");
						$j('.kb-star-rating label.kb-active-star').removeClass('kb-active-star');
						$j('.kb-star-rating label.kb-active-star-self').removeClass('kb-active-star-self');
					});
					$j('.kb-star-rating').on("mouseleave focusout",function() {
						kbArticleRating.setStarsRating();
					});
					$j('.kb-star-rating label.icon-star-empty').on("mouseenter focusin", function(){
						$j(this).addClass('kb-hover-star').prevAll().addClass('kb-hover-star');
					});
					$j('.kb-star-rating label.icon-star-empty').on("mouseleave focusout",function() {
						$j(this).removeClass('kb-hover-star').prevAll().removeClass('kb-hover-star');
					});
					if(false){
						$j('#articleStarRatingGroup').find("*").unbind();
					}
					
					function useIconStarImageClassess(){
						$j('.kb-star-rating').addClass('kb-star-image');
						$j('.icon-star-empty').mouseover(function() {
							$j(this).addClass('kb-hover-star').prevAll().addClass('kb-hover-star');
						}).mouseout(function() {
							$j(this).removeClass('kb-hover-star').prevAll().removeClass('kb-hover-star');
						});
					}
					updateCurrentStarRatingForAria();
				});
					function getUIMessage(params) {
						var message = "This article has {0} star rating.Use up and down arrow keys to select and submit the rating.";
					
						return message.replace(/\{(\d+)\}/g, function() {
						return params[arguments[1]];
						});
					};
				
					function removeToolTipForRatingParent(){
						$j('#articleStarRatingGroup').removeAttr("title","");
						$j('#articleStarRatingGroup').removeAttr("data-original-title","");
					}
					
					function updateCurrentStarRatingForAria(currentRating){
						if(currentRating)
							$j('#articleStarRatingGroup').attr("aria-label", getUIMessage([Math.round(currentRating)]));
						else{
							$j('#articleStarRatingGroup').attr("aria-label","This article has not been rated yet.Use up and down arrow keys to select and submit the rating." );

						}
						if(false ){
							$j('#articleStarRatingGroup').attr('tabindex', '0');
						}
					}
				</script><input id="rating_value" type="hidden" value=""></input><input id="num_ratings" type="hidden" value="0"></input><input id="rated_value" type="hidden"></input><div role="group" id="articleStarRatingGroup" class="accessibility-disabled" style="display:inline-flex"><span class="rating kb-star-rating "><input type="radio" class="rating-input" id="rating-input-1-1" name="rating-input-1" aria-label="1-star rating" title="1-star rating"></input><label data-index="1" for="rating-input-1-1" class="rating-star icon-star-empty"></label><input type="radio" class="rating-input" id="rating-input-1-2" name="rating-input-1" aria-label="2-star rating" title="2-star rating"></input><label data-index="2" for="rating-input-1-2" class="rating-star icon-star-empty"></label><input type="radio" class="rating-input" id="rating-input-1-3" name="rating-input-1" aria-label="3-star rating" title="3-star rating"></input><label data-index="3" for="rating-input-1-3" class="rating-star icon-star-empty"></label><input type="radio" class="rating-input" id="rating-input-1-4" name="rating-input-1" aria-label="4-star rating" title="4-star rating"></input><label data-index="4" for="rating-input-1-4" class="rating-star icon-star-empty"></label><input type="radio" class="rating-input" id="rating-input-1-5" name="rating-input-1" aria-label="5-star rating" title="5-star rating"></input><label data-index="5" for="rating-input-1-5" class="rating-star icon-star-empty"></label></span><span id="placeholder-icon-star" class="icon-star" style="visibility:hidden; position: absolute;"></span></div><div class="kb-article-view-count">2 views</div><article id="article" class="snc-article-content-text row"><p>This is a step by step guide to identify users with duplicate active accounts in ServiceNow.</p>
<p>Issue: We wanted to change SSO login from samaccounname to UPN.&nbsp; However we encountered an issue: many &ldquo;active&rdquo; SN users were not getting updated on import with UPNs. The reason is twofold &ndash; 1) some users are deleted in LDAP and so the SN sys_user table will never get updated, 2) a BR was throwing an error on what it saw as duplicate notification devices (email). In reality, this was mostly due to some users having duplicate accounts, only one which should be active. But the business rule did not account for inactive vs active accounts, hence skipping the user record of the active account. Once we corrected the issue ensuring that all active users in SN were actually active existing users in LDAP, we modified the BR script to allow an update to a user if their account with a duplicate notification device was inactive. This updated the UPNs as well as their emails.</p>
<p>1) Created a Script Include called "getDuplicates". We can call this script in the list view of our "sys_user" table in order to filter and find users with duplicate accounts in SN. In our case, we will be looking based on USC ID, as users can have unique emails and UPNs associated with the same USC ID.</p>
<pre class="language-javascript"><code>var getDuplicates = Class.create();
getDuplicates.prototype = Object.extendsObject(AbstractAjaxProcessor, {
	getDuplicates: function(table, field) {
	var dupRecords = [];
	var gaDupCheck = new GlideAggregate(table);
	gaDupCheck.addAggregate('COUNT', field);
	gaDupCheck.addNotNullQuery(field);
	gaDupCheck.groupBy(field);
	gaDupCheck.addHaving('COUNT', '&gt;', 1);
	gaDupCheck.query();
	while (gaDupCheck.next()) {
	dupRecords.push(gaDupCheck[field].toString());
}
	return dupRecords;
},

type: 'getDuplicates'
});</code></pre>
<p>2) Use this to filter on the "sys_user" table, where:</p>
<p><span style="background-color: #fbeeb8;">USC ID Number is javascript:new global.getDuplicates().getDuplicates('sys_user', 'u_uscid_number')</span></p>
<p style="padding-left: 40px;">a) Save this filter to access it easily for future reference (ex: getDupes). <span dir="ltr">Click on the filter icon, and save the filter. You can then choose to save to yourself, your group, or everyone:</span></p>
<p style="padding-left: 40px;"><img src="/sys_attachment.do?sys_id=9505bb30dbc2ca508a4c7504e29619d0" alt="" width="898" height="467" data-library="false" /></p>
<p style="padding-left: 40px;">&nbsp;</p>
<p>3) Once we filter on duplicate users associated with the same USC ID, we can further filter out users based on "memberof", "dn", or excluding terms like "test".</p>
<p>4) In order to perform a cleanup of duplicate users and disable the ones we do not use, we create a new LDAP import set table of all users "Marshall LDAP Cleanups", not broken up by OU. Run this directly from the Data Source "Marshall LDAP Cleanup" (note the LDAP target's OU Definition "LDAP User's Cleanup" contains no RDN). The transform map "LDAP Cleanup Temp Users Import" maps the fields from our import set table into our ServiceNow table "LDAP Temp Users", which we will use to run against our "sys_user" table in our disabling script.</p>
<p>Steps to achieve this outcome are:</p>
<ol style="list-style-position: inside;">
<li>Add new UPN field map to user table (sys_user)</li>
<li>Add UPN field to existing LDAP table transform maps (mapping assist)</li>
<li>Create new system table &ldquo;LDAP Temp Users&rdquo; with necessary dictionary entries (active, usc id, user id, etc)</li>
<li>LDAP import process for new import set table &ldquo;Marshall LDAP Cleanup&rdquo;:
<ol style="list-style-type: lower-alpha; list-style-position: inside;">
<li>New OU definition</li>
<li>New Data Source</li>
<li>New Table transform map</li>
</ol>
</li>
</ol>
<p>This populates our new system table LDAP Temp Users.</p>
<p>5) Created a Fix Script that compares active SN users in the "sys_user" table against non-existent users in the LDAP import "Deactivate accounts deleted from AD", and run to disable them. This script is looking at our "LDAP Temp Users" table and if a user does not exist there, but is found in the User table, disable it and make it inactive.</p>
<pre class="language-javascript"><code>// Query the main users table (sys_users)
var mainUsers = new GlideRecord('sys_user');
mainUsers.query();

while (mainUsers.next()) {
    var mainUserSamAccount = mainUsers.getValue('user_name');
    
    // Query the temp users table (u_ldap_temp_user) for the current main user's samaccountname
    var tempUsers = new GlideRecord('u_ldap_temp_user');
    tempUsers.addQuery('u_user_name', mainUserSamAccount);
    tempUsers.query();
    
    // If no corresponding record is found in temp users table, update attributes in main users table
    if (!tempUsers.next()) {
        mainUsers.setValue('active', false);
        mainUsers.setValue('locked_out', true);
        mainUsers.update();
    }
}</code></pre>
<p>6) Update BR to allow update of users who have a duplicate notification device on an inactive account record.</p>
<p>7) Manually run LDAP import sets to update remaining records</p>
<p>8) Once the above is complete and we have a clean sys_user table, we can upload our second update set, which just sets the coalesce on UPN.</p></article></div><script type="text/javascript">function openAttachment(url, name) {
			window.open(url, name, "toolbar=no,menubar=no,personalbar=no,width=800,height=600," +
						"scrollbars=yes,resizable=yes");
			
		}</script><div class="snc-article-header-author"><div class="snc-article-author"><div id="authorGhost" class="icon-user-profile snc-article-header-author-ghost"></div><div class="author-info"><div id="articleAuthor" class="snc-article-footer-metadata-published" style="display: block;padding-top: 5px">Authored by Menna Kearns (megankea)</div><div id="articleModifiedLabel" class="snc-article-footer-metadata-published">Last modified just now</div></div></div></div><div id="articleFooterSection" class="snc-article-footer-section" style="display: none;"><div class="snc-article-footer-section-ratings"><script>function KbArticleRatingClass() {
						var THANK_YOU = "Thank you";
						var currentId = 'ded8a140dbc2c6508a4c7504e29619d6';
						var feedbackRequestState = null;
						function ajaxPost(value) {
							if (currentId) {
								var ajax = new GlideAjax('KBAjax');
								ajax.addParam('sysparm_type', 'saveUseful');
								ajax.addParam('sysparm_useful', value);
								ajax.addParam("sysparm_article_id", currentId);
								var query = $j('#sysparm_search');
								ajax.addParam('sysparm_search', (query.length) ? escape(query.val()) : '');
								ajax.addParam("ts_queryId", "");
								ajax.getXMLAnswer(postUsefulCallback);
							}
						}

						function postUsefulCallback(answer) {
							var data = answer.evalJSON(true);
							if (!data) {
								return kbViewArticle.showErrorMessage('Useful rating not submitted');
							}
							if (!data.success) {
								return kbViewArticle.showErrorMessage(data.message);
							}
						}

						function feedback(value) {
							// animation
							if(feedbackRequestState === value)
								return;
							feedbackRequestState = value;
							var box = $j('.kb_box_centered');
							var notification = $j('#kb_feedback_notification');;

                            box.fadeOut('slow', function() {
                                notification.fadeIn('slow');
                                box.remove();
								setTimeout(function() {
									  notification.children('.icon-cross.close').focus();
								}, 800);
					
                            });

							ajaxPost(value);
						}
					
					    function close() {
                            var notification = $j('#kb_feedback_notification');
                            var ratings = $j('.snc-article-footer-section-ratings');
					
                            notification.animate({opacity: 0}, 600, function() {
								ratings.animate({
									height: 0,
                                    opacity: 0,
									padding: 0,
									margin: 0
                                }, 600, function() {
                                    ratings.remove();
                                    if($j('#comment_link_div_cancel :visible').length != 0)
                                    	$j('#comment_link_div_cancel .pointerhand').focus();
                                    else if($j('#comment_link_div :visible').length != 0)
                                    	$j('#comment_link_div .pointerhand').focus();
                                });
                            });
                        }

						return {
							feedback: feedback,
							close: close
						};
					}

					// create an instance
					var kbArticleRating = new KbArticleRatingClass();</script><div class="kb_box_centered"><span class="sr-only">Was this article helpful?</span><span class="kb-article-yn-label"><span id="kb_helpful_yn_label" aria-hidden="true">Helpful?</span></span><span role="group" aria-label="Was this article helpful?" class="kb-article-yn-box"><button class="btn btn-success-subdued kb-article-yes-btn" onclick="kbArticleRating.feedback('yes')" aria-label="Yes,this article was helpful">Yes</button><button class="btn btn-destructive-subdued kb-article-no-btn" onclick="kbArticleRating.feedback('no')" aria-label="No,this article was not helpful">No</button><span class="kb-article-yn-percentage" aria-hidden="true"></span></span></div><div id="kb_feedback_notification" class="notification notification-closable notification-info notification_message_sticky" style="display:none"><span class="icon-cross close" tabindex="0" role="button" aria-label="Close Notification" onclick="kbArticleRating.close()"></span><span role="alert">Thank you</span></div></div><div id="kbCommentsAndLiveFeedDisplay" class="snc-comments-live-feed-cntnr"><iframe id="iframe_live_feed" src="$knowledge_feedback.do?sysparm_stack=no&amp;&amp;sysparm_kb_id=ded8a140dbc2c6508a4c7504e29619d6" width="100%" height="1" scrolling="no" aria-label="Knowledge feedback frame"></iframe><script>CustomEvent.observe('content_frame.resized', resizeFrame);
        CustomEvent.observe('content_frame.loaded', resizeFrame);

        function resizeFrame(id, height){
            if (!id)
                return;
    
            var f = $(id);
            if (!f)
                return;
		
            if(height > 107)  
				f.height = height+16;
		    else
		        f.height = height;
		
			if(parent.document) {
				parent.CustomEvent.fire('content_frame.resized', window.name, parent.document.body.scrollHeight);			
			}
        };</script></div></div><div id="articleFooter" class="snc-article-footer"><div class="snc-article-footer-metadata-permalink"><a href="#" id="permalink" aria-label="Copy Permalink">Copy Permalink</a></div><script language="javascript">$j('#permalink').click(
			function(){
				//generate direct url to this article, by getting the domain and adding sysparm_article=NUMBER_OF_ARTICLE
				copyToClipboard(window.location.origin + '/kb_view.do?sysparm_article=KB0000946');
				$j('#permalink').focus();
				return false;
			}
		);</script></div><script language="javascript" src="KnowledgeIframeFix.jsdbx"></script><div style="border:none; visibility:hidden"><form name="sys_personalize" method="GET" action="slushbucket.do"><input type="hidden" name="sysparm_referring_url" value="kb_view.do?sysparm_article=KB0000946"></input><input type="hidden" name="sysparm_view" value=""></input></form></div><script type="text/javascript" src="/scripts/ui_page_footer.jsx?v=03-06-2024_1225"></script><span style="display:none" data-comments="js_includes_last_doctype"></span><script type="text/javascript" src="/scripts/thirdparty/dom_purify/purify.jsx?v=03-06-2024_1225&amp;sysparm_substitute=false"></script><script>NOW.xperf.lastDoctypeBegin = NOW.xperf.now();</script><script type="text/javascript" src="/scripts/doctype/js_includes_last_doctype.jsx?v=03-06-2024_1225&amp;lp=Mon_Apr_22_10_01_21_PDT_2024&amp;c=18_236"></script><script type="text/javascript" src="/scripts/heisenberg/heisenberg_all.jsx?v=03-06-2024_1225"></script><script type="text/javascript" src="/scripts/js_includes_list_edit_doctype.jsx?v=03-06-2024_1225&amp;lp=Mon_Apr_22_10_01_21_PDT_2024&amp;c=18_236"></script><script type="text/javascript" src="/scripts/transaction_scope_includes.jsx?v=03-06-2024_1225"></script><script>if ('') 
			GlideTransactionScope.setTransactionScope('');
		if ('') 
			GlideTransactionScope.setRecordScope('');
		if ('') 
			GlideTransactionScope.setTransactionUpdateSet('');
		if (typeof g_form != 'undefined')
			$(g_form.getFormElement()).fire('glidescope:initialized', {gts : GlideTransactionScope});</script><span style="display:none" data-comments="requires"></span><script>NOW.xperf.lastDoctypeEnd = NOW.xperf.now();</script><span style="display:none" data-comments="db_context_menu_script"></span><script>NOW.xperf.dbContextBegin = NOW.xperf.now();</script><script>NOW.xperf.dbContextEnd = NOW.xperf.now();</script><span style="display:none" data-comments="db_context_menu_script"></span><script type="text/javascript" src="/scripts/doctype/z_last_include.jsx?v=03-06-2024_1225"></script></body><script type="text/html" id="popup_template"><div class="popup popup_form" style=""><iframe src="$src" style=""></iframe></div></script></html>